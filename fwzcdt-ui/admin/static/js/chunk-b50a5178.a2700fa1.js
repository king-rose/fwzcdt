(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b50a5178"],{"012f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"header"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{inline:!0,model:t.queryParams,"label-width":"108px",size:"mini"}},[a("el-form-item",{attrs:{label:"需求编号:",prop:"demandId"}},[a("el-input",{attrs:{placeholder:"需求编号.."},model:{value:t.queryParams.demandId,callback:function(e){t.$set(t.queryParams,"demandId",e)},expression:"queryParams.demandId"}})],1),a("el-form-item",{attrs:{label:"需求名称:",prop:"demandName"}},[a("el-input",{attrs:{placeholder:"请输入需求名称.."},model:{value:t.queryParams.demandName,callback:function(e){t.$set(t.queryParams,"demandName",e)},expression:"queryParams.demandName"}})],1),a("el-form-item",{attrs:{label:"任务单状态:",prop:"taskState"}},[a("el-select",{model:{value:t.queryParams.taskState,callback:function(e){t.$set(t.queryParams,"taskState",e)},expression:"queryParams.taskState"}},t._l(t.taskStateOptions,(function(t){return a("el-option",{key:t.dictValue,attrs:{label:t.dictLabel,value:t.dictValue}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"cyan"},on:{click:t.handleQuery}},[t._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),a("right-tool-chart-bar",{attrs:{showSearch:t.showSearch,showChart:t.showChart},on:{"update:showSearch":function(e){t.showSearch=e},"update:show-search":function(e){t.showSearch=e},queryTable:t.getList,"update:showChart":function(e){t.showChart=e},"update:show-chart":function(e){t.showChart=e}}})],1),a("div",[a("div",{staticStyle:{"margin-top":"40px","text-align":"center",width:"100%"}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showChart,expression:"!showChart"}],attrs:{id:"chart"}})])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.taskList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{align:"center",label:"需求编号",prop:"demandId"}}),a("el-table-column",{attrs:{align:"center",label:"需求名称",prop:"demandName"}}),a("el-table-column",{attrs:{formatter:t.statusFormat,align:"center",label:"需求状态",prop:"demandState"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:"0"===e.row.demandState?"demandClass":"1"===e.row.demandState?"demandClass_1":"demandClass_2",attrs:{title:t.statusFormat(e.row,e.column)},on:{click:function(a){return t.acceptTask(e.row)}}},[t._v(t._s(t.statusFormat(e.row,e.column)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"任务状态",prop:"taskState"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{class:"1"===e.row.taskState?"demandClass":"2"===e.row.taskState?"demandClass_1":"3"===e.row.taskState?"demandClass_2":"demandClass_3"},[t._v(" "+t._s("0"===e.row.taskState?"未受理":"1"===e.row.taskState?"已派送":"2"===e.row.taskState?"已受理":"3"===e.row.taskState?"已通过":"已驳回"))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"需求申请日期",prop:"applyTime"}}),a("el-table-column",{attrs:{align:"center",label:"需求申请人",prop:"applyUserName"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{limit:t.queryParams.pageSize,page:t.queryParams.pageNum,total:t.total},on:{"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},pagination:t.getList}})],1),a("el-dialog",{attrs:{visible:t.open,"append-to-body":"","destroy-on-close":"",title:"任务单受理信息"},on:{"update:visible":function(e){t.open=e}}},[a("el-form",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"需求编号:"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.demandId,callback:function(e){t.$set(t.form,"demandId",e)},expression:"form.demandId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"需求名称:"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.demandName,callback:function(e){t.$set(t.form,"demandName",e)},expression:"form.demandName"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"需求描述:"}},[a("el-input",{attrs:{disabled:"",type:"textarea"},model:{value:t.form.demandDes,callback:function(e){t.$set(t.form,"demandDes",e)},expression:"form.demandDes"}})],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading_1,expression:"loading_1"}],attrs:{data:t.faceList}},[a("el-table-column",{attrs:{label:"关联系统",prop:"sysName"}}),a("el-table-column",{attrs:{label:"接口编号",prop:"jkNameEn"}}),a("el-table-column",{attrs:{label:"接口名称",prop:"jkNameCn"}}),a("el-table-column",{attrs:{label:"工作用时(天)",prop:"workTime"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticStyle:{width:"120px"},attrs:{min:1},model:{value:e.row.workDay,callback:function(a){t.$set(e.row,"workDay",a)},expression:"scope.row.workDay"}})]}}])}),a("el-table-column",{attrs:{label:"系统负责人",prop:"principal"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{disabled:"1"===e.row.isAccept,icon:"1"===e.row.isAccept?"el-icon-finished":"el-icon-bottom-right",size:"mini",type:"text"},on:{click:function(a){return t.acceptInterFace(e.row)}}},[t._v(" "+t._s("1"===e.row.isAccept?"已受理":"受理")+" ")])]}}])})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.btn,expression:"!btn"}],staticClass:"dialog-footer mt20",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:"1"!==t.taskState,type:"primary"},on:{click:t.submit}},[t._v(" "+t._s("1"===t.taskState?"提 交":"已提交")+" ")]),a("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},r=[],s=(a("d3b7"),a("159b"),a("d81d"),a("1c3db")),o=a("313e"),i={name:"taskList",data:function(){return{chart:{demandName:[],noAccepted:[],noAccepted_rest:[],accepted:[],accepted_rest:[],accepting:[],accepting_test:[],developing:[],developing_rest:[]},showChart:!1,btn:!0,demandId:"",taskState:"",workTime:1,open:!1,queryParams:{pageNum:1,pageSize:10,taskState:void 0,demandId:void 0,demandName:void 0},form:{},stateOptions:[],showSearch:!0,loading:!1,loading_1:!1,taskList:[],faceList:[],total:0,demandStateOptions:[],taskStateOptions:[],percentage:0,ids:[],single:!0,multiple:!0}},mounted:function(){this.initChart()},created:function(){var t=this;this.getList(),this.getDicts("aesb_demand_state").then((function(e){t.demandStateOptions=e.data})),this.getDicts("aesb_task_state").then((function(e){t.taskStateOptions=e.data}))},methods:{initChart:function(){var t=this;this.chart.noAccepted=[],this.chart.noAccepted_rest=[],this.chart.accepted=[],this.chart.accepted_rest=[],this.chart.accepting=[],this.chart.accepting_test=[],this.chart.developing=[],this.chart.developing_rest=[],this.chart.demandName=[],Object(s["f"])(this.queryParams).then((function(e){e.data.forEach((function(e){e.pswsl?(t.chart.noAccepted.push(e.pswsl),t.chart.noAccepted_rest.push(100-e.pswsl)):(t.chart.noAccepted.push(0),t.chart.noAccepted_rest.push(100)),e.psysl?(t.chart.accepted.push(e.psysl),t.chart.accepted_rest.push(100-e.psysl)):(t.chart.accepted.push(0),t.chart.accepted_rest.push(100)),e.psz?(t.chart.accepting.push(e.psz),t.chart.accepting_test.push(100-e.psz)):(t.chart.accepting.push(0),t.chart.accepting_test.push(100)),e.kfz?(t.chart.developing.push(e.kfz),t.chart.developing_rest.push(100-e.kfz)):(t.chart.developing.push(0),t.chart.developing_rest.push(100)),t.chart.demandName.push(e.xqmc)}));var a=document.getElementById("chart"),n=o["init"](a),r=[{Text:"派送未受理"},{Text:"派送已受理"},{Text:"审批中"},{Text:"开发中"}],s={title:{show:!0,text:"任务进度",textStyle:{color:"#fff"}},backgroundColor:"#44464c",grid:{left:"5%",right:"5%",bottom:"10%",top:"5%",containLabel:!0},xAxis:{type:"value",splitLine:{lineStyle:{color:"rgba(255,255,255,0.3)"}},splitNumber:4,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{color:"#fff",align:"left",fontSize:20,formatter:function(t,e){return r[e]?r[e].Text:""}}},yAxis:{type:"category",axisLine:{lineStyle:{color:"rgba(255,255,255,0.3)"}},splitLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"turquoise",fontSize:20},data:t.chart.demandName},series:[{name:"1",type:"bar",stack:"processBar",barWidth:34,label:{show:!0,fontSize:20,textBorderColor:"#000",textBorderWidth:2,formatter:function(t){var e=t.data;return 0===e?"":e+"%"}},itemStyle:{color:function(t){return t.data<30?"#f47f7e":t.data<90&&t.data>=30?"#ffba00":"#10df6a"}},data:t.chart.noAccepted},{name:"1_REST",type:"bar",stack:"processBar",itemStyle:{color:"rgb(186,179,189,0.1)"},data:t.chart.noAccepted_rest},{name:"2",type:"bar",stack:"processBar",label:{show:!0,fontSize:20,textBorderColor:"#000",textBorderWidth:2,formatter:function(t){var e=t.data;return 0===e?"":e+"%"}},itemStyle:{color:function(t){return t.data<30?"#f47f7e":t.data<90&&t.data>=30?"#ffba00":"#10df6a"}},data:t.chart.accepted},{name:"2_REST",type:"bar",stack:"processBar",itemStyle:{color:"rgb(186,179,189,0.1)"},data:t.chart.accepted_rest},{name:"3",type:"bar",stack:"processBar",label:{show:!0,fontSize:20,textBorderColor:"#000",textBorderWidth:2,formatter:function(t){var e=t.data;return 0===e?"":e+"%"}},itemStyle:{color:function(t){return t.data<30?"#f47f7e":t.data<90&&t.data>=30?"#ffba00":"#10df6a"}},data:t.chart.accepting},{name:"3_REST",type:"bar",stack:"processBar",itemStyle:{color:"rgb(186,179,189,0.1)"},data:t.chart.accepting_test},{name:"4",type:"bar",stack:"processBar",label:{show:!0,fontSize:20,textBorderColor:"#000",textBorderWidth:2,formatter:function(t){var e=t.data;return 0===e?"":e+"%"}},itemStyle:{color:function(t){return t.data<30?"#f47f7e":t.data<90&&t.data>=30?"#ffba00":"#10df6a"}},data:t.chart.developing},{name:"4_REST",type:"bar",stack:"processBar",itemStyle:{color:"rgb(186,179,189,0.1)"},data:t.chart.developing_rest}]};s&&n.setOption(s)}))},getList:function(){var t=this;this.loading=!0,Object(s["i"])(this.queryParams).then((function(e){t.taskList=e.list,t.total=e.total})),this.loading=!1},statusFormat:function(t,e){return this.selectDictLabel(this.demandStateOptions,t.demandState)},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.id})),this.single=1!==t.length,this.multiple=!t.length},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},acceptTask:function(t){this.open=!0,this.loading_1=!0,this.demandId=t.demandId,this.taskState=t.taskState,this.getDetail(this.demandId)},getDetail:function(t){var e=this;Object(s["e"])(t).then((function(t){var a=e;a.faceList=t.data.list,a.faceList.forEach((function(t){"0"===t.isAccept?a.btn=!0:a.btn=!1})),a.form=t.data,a.loading_1=!1}))},submit:function(){var t=this,e={demandId:this.demandId,taskState:"2"};Object(s["j"])(e).then((function(e){t.open=!1,t.msgSuccess("操作成功"),t.getList()}))},cancel:function(){this.open=!1},acceptInterFace:function(t){var e=this,a={demandId:t.demandId,isAccept:"1",acceptTime:new Date,jkVersionId:t.jkVersionId,workDay:t.workDay};Object(s["k"])(a).then((function(a){200===a.code&&e.getDetail(t.demandId)}))}}},c=i,l=(a("7659"),a("2877")),d=Object(l["a"])(c,n,r,!1,null,"16947288",null);e["default"]=d.exports},"1c3db":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"f",(function(){return s})),a.d(e,"a",(function(){return o})),a.d(e,"k",(function(){return i})),a.d(e,"i",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"g",(function(){return d})),a.d(e,"h",(function(){return u})),a.d(e,"c",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"j",(function(){return h}));var n=a("b775");function r(t){return Object(n["a"])({url:"/demand/"+t,method:"delete"})}function s(t){return Object(n["a"])({url:"/demand/process",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/demand/downFace",method:"put",data:t})}function i(t){return Object(n["a"])({url:"/demand/updateFace",method:"put",data:t})}function c(t){return Object(n["a"])({url:"/demand/taskList",method:"get",params:t})}function l(t){return Object(n["a"])({url:"/demand/asso",method:"get",params:t})}function d(t){return Object(n["a"])({url:"/demand/list",method:"get",params:t})}function u(t){return Object(n["a"])({url:"/demand/acceptList",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/demand",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/demand/"+t,method:"get"})}function h(t){return Object(n["a"])({url:"/demand",method:"put",data:t})}},7659:function(t,e,a){"use strict";a("e437")},e437:function(t,e,a){}}]);